# 3.6. Компьютерные сети, лекция 1 - Дмитрий Щербаков
### 1. Работа c HTTP через телнет.
### - Подключитесь утилитой телнет к сайту stackoverflow.com telnet stackoverflow.com 80
### - отправьте HTTP запрос
```
GET /questions HTTP/1.0
HOST: stackoverflow.com
[press enter]
[press enter]
```
### - В ответе укажите полученный HTTP код, что он означает?
```commandline
vagrant@vagrant:~$ telnet stackoverflow.com 80
Trying 151.101.129.69...
Connected to stackoverflow.com.
Escape character is '^]'.
GET /questions HTTP/1.0
HOST: stackoverflow.com

HTTP/1.1 301 Moved Permanently
cache-control: no-cache, no-store, must-revalidate
location: https://stackoverflow.com/questions
x-request-guid: e2c37e67-55db-4037-9d1b-dbe27f630b24
feature-policy: microphone 'none'; speaker 'none'
content-security-policy: upgrade-insecure-requests; frame-ancestors 'self' https://stackexchange.com
Accept-Ranges: bytes
Date: Sun, 28 Nov 2021 07:08:44 GMT
Via: 1.1 varnish
Connection: close
X-Served-By: cache-bma1640-BMA
X-Cache: MISS
X-Cache-Hits: 0
X-Timer: S1638083325.769373,VS0,VE101
Vary: Fastly-SSL
X-DNS-Prefetch-Control: off
Set-Cookie: prov=8fe05d96-9603-427e-efdf-3a909298ce12; domain=.stackoverflow.com; expires=Fri, 01-Jan-2055 00:00:00 GMT; path=/; HttpOnly

Connection closed by foreign host.
```
В приведенном выводе:
* **HTTP/1.1 301 Moved Permanently** - ошибка из группы перенаправлений, сообщающая о том, что сайт перемещен на постоянной основе (адрес нового расположения указывается в поле Location).
* **cache-control: no-cache, no-store, must-revalidate** - пареметры кэширования. Здесь:
  - `no-cache` - параметр, указывающий на то, что требуется проверка актуальности имеющейся копии из кэша перед ее использованием. Можно использовать cache-control: no-cache, чтобы указать браузеру сначала проверить ресурс на сервере, и если «свежей» версии нет (статус 304), использовать кэшированную версию. Если же сервер предложит свежий контент, он пришлет ответ со статусом 200 и новый файл;
  - `no-store` - строгая директива, не позволяет хранить информацию в любом кэше;
  - `must-revalidate` - Говорит, что каждый запрос нужно делать заново, и ни при каких условиях не предоставлять пользователю закешированный контент. Имеет преимущество над всеми другими директивами, которые разрешают кэширование. При использовании с `max-age`, директивы устанавливают время, в течение которого данные в кэше будут считаться актуальными;
* **location: https://stackoverflow.com/questions** - в случае, когда сопоставлен с кодом 3xx, предлагает браузеру загрузить другую страницу (осуществляет перенаправление);
* **x-request-guid: e2c37e67-55db-4037-9d1b-dbe27f630b24** - опциональный параметр, который задает уникальный идентификатор клиента, используемый далее в маркировке событий в журнале, что позволяет впоследствии осуществить анализ взаимодействия и локализовать сбой, если это потребуется;
* **feature-policy: microphone 'none'; speaker 'none'** - заголовок, позволяющий управлять возможностями браузера. Здесь:
  - `microphone 'none'` - блокирует использование микрофона на странице;
  - `speaker 'none'` - блокирует использование устройств вывода звука;
* content-security-policy: upgrade-insecure-requests; frame-ancestors 'self' https://stackexchange.com - механизм обеспечения безопасности, с помощью которого можно защищаться от атак с внедрением контента, например, межсайтового скриптинга (XSS, cross site scripting). Здесь:
  - `upgrade-insecure-requests` - указывает на то, что URL-адреса содержимого из небезопасных (HTTP) источников должны быть безопасно получены по протоколу HTTPS;
  - `frame-ancestors 'self' https://stackexchange.com` - указывает каким образом должен встраиваться ресурс на страницу (допустимых родителей). В указанном примере, сайт может быть загружен только внутри фреймов `self` (самого себя) либо `https://stackexchange.com`;
* **Accept-Ranges: bytes** - маркер, который использует сервер, чтобы уведомить клиента о поддержке "запросов по кускам". Его значение указывает единицу измерения, которая может быть использована для определения диапазона чтения. При наличии заголовка Accept-Ranges, браузер может попытаться возобновить прерванную загрузку, а не запускать её с самого начала. При использовании `bytes`,
единицей измерения для диапазона являются байты;
* **Date: Sun, 28 Nov 2021 07:08:44 GMT** - данный заголовок содержит дату и время формирования ответа на запрос;
* **Via: 1.1 varnish** - заголовок `Via` добавляется прокси-серверами. В нашем случае, содержит версию протокола (1.1) и имя (название) прокси-сервера `varnish`;
* **Connection: close** - заголовок определяет, остаётся ли сетевое соединение активным после завершения текущей транзакции (запроса). `close` указывает, что клиент или сервер хотели бы закрыть соединение. Это значение по умолчанию для запросов HTTP/1.0.
* **X-Served-By: cache-bma1640-BMA** - нестандартный заголовок, внедренный сервисом Fastly для идентификации кэширующего сервера, сформировавшего ответ. Данные представляются в формате: `cache-{datacenter}{nodeid}-{datacenter}`;
* **X-Cache: MISS** - нестандартный заголовок, внедренный сервисом Fastly. Сообщает, предоставил ли прокси ответ на запрос из кэша (`HIT`) или нет (`MISS`);
* **X-Cache-Hits: 0** - нестандартный заголовок, внедренный сервисом Fastly. Указывает сколько раз данный объект был прочитан из кэша текущего кэширующего сервера;
* **X-Timer: S1638083325.769373,VS0,VE101** - нестандартный заголовок, внедренный сервисом Fastly. Содержит параметры времени взаимодействия в формате: `S{unixStartTimeSeconds},VS0,VE{durationMilliseconds}`, где `{unixStartTimeSeconds}` - время начала взаимодействия в формате unixtime; `{durationMilliseconds}` - время, затраченное на формирование запроса в мс.
* **Vary: Fastly-SSL** - параметр определяет выбор какого-либо из множественных вариантов ресурса в кэше, привязанных к одному и тому же имени. Может использоваться для корректного выбора языка страницы или форматирования в зависимости от используемого устройства.
* **X-DNS-Prefetch-Control: off** - включает и отключает предварительное разрешение браузером DNS имен внешних ресурсов, которые используются на сайте.
* **Set-Cookie: prov=8fe05d96-9603-427e-efdf-3a909298ce12; domain=.stackoverflow.com; expires=Fri, 01-Jan-2055 00:00:00 GMT; path=/; HttpOnly** - заголовок используется для отправки cookies с сервера на агент пользователя. Здесь:
  * `prov=...` - имя и значение cookie;
  * `domain=.stackoverflow.com;` - хост, на который будет отправляться cookie;
  * `expires=...` - максимальное время жизни cookie;
  * `path=/` - путь, который должен существовать в запрошенном URL, иначе браузер не отправит заголовок Cookie. `/` - cookie будет отправляться со всеми запросами;
  * `HttpOnly` - запрещает JavaScript доступ к cookie.


